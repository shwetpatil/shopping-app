(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{999:function(e,t,r){Promise.resolve().then(r.t.bind(r,2625,23)),Promise.resolve().then(r.bind(r,9137)),Promise.resolve().then(r.bind(r,3388)),Promise.resolve().then(r.t.bind(r,6340,23)),Promise.resolve().then(r.t.bind(r,9438,23))},9137:function(e,t,r){"use strict";r.d(t,{Header:function(){return d}});var s=r(7573),a=r(8146),n=r(5731),o=r(8779),l=r(6643),c=r(5330),i=r(286),u=r(3447);function d(){var e;let{user:t,isAuthenticated:r,logout:d}=(0,i.a)(),{cart:h}=(0,u.j)(),f=(null==h?void 0:null===(e=h.items)||void 0===e?void 0:e.reduce((e,t)=>e+t.quantity,0))||0;return(0,s.jsx)("header",{className:"sticky top-0 z-50 border-b bg-white shadow-sm",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,s.jsx)(a.default,{href:"/",className:"text-2xl font-bold text-primary-600",children:"ShopApp MFE"}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center space-x-6",children:[(0,s.jsx)(a.default,{href:"/products",className:"hover:text-primary-600",children:"Products"}),(0,s.jsx)(a.default,{href:"/categories",className:"hover:text-primary-600",children:"Categories"}),(0,s.jsx)(a.default,{href:"/deals",className:"hover:text-primary-600",children:"Deals"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:(0,s.jsx)(n.Z,{className:"h-5 w-5"})}),(0,s.jsx)(a.default,{href:"/wishlist",className:"p-2 hover:bg-gray-100 rounded-full",children:(0,s.jsx)(o.Z,{className:"h-5 w-5"})}),(0,s.jsxs)(a.default,{href:"/cart",className:"p-2 hover:bg-gray-100 rounded-full relative",children:[(0,s.jsx)(l.Z,{className:"h-5 w-5"}),f>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:f})]}),r?(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsxs)("button",{className:"flex items-center space-x-2 p-2 hover:bg-gray-100 rounded-full",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"hidden md:inline",children:null==t?void 0:t.firstName})]}),(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 hidden group-hover:block",children:[(0,s.jsx)(a.default,{href:"/dashboard",className:"block px-4 py-2 hover:bg-gray-100",children:"Dashboard"}),(0,s.jsx)(a.default,{href:"/dashboard/orders",className:"block px-4 py-2 hover:bg-gray-100",children:"Orders"}),(0,s.jsx)("button",{onClick:d,className:"block w-full text-left px-4 py-2 hover:bg-gray-100",children:"Logout"})]})]}):(0,s.jsx)(a.default,{href:"/auth/login",className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700",children:"Login"})]})]})})})}},3388:function(e,t,r){"use strict";r.d(t,{Providers:function(){return u}});var s=r(7573),a=r(6814),n=r(7930),o=r(9426),l=r(7653),c=r(286),i=r(3447);function u(e){let{children:t}=e,[r]=(0,l.useState)(()=>new a.S({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1,retry:1}}}));return(0,s.jsxs)(n.aH,{client:r,children:[(0,s.jsx)(c.H,{children:(0,s.jsx)(i.Z,{children:t})}),(0,s.jsx)(o.t,{initialIsOpen:!1})]})}},286:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return c}});var s=r(7573),a=r(7653),n=r(1493);let o=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[c,i]=(0,a.useState)(!0);(0,a.useEffect)(()=>{localStorage.getItem("accessToken")?f():i(!1)},[]);let u=async(e,t)=>{let{accessToken:r,refreshToken:s,user:a}=(await n.x.post("/auth/login",{email:e,password:t})).data;localStorage.setItem("accessToken",r),localStorage.setItem("refreshToken",s),l(a)},d=async e=>{let{accessToken:t,refreshToken:r,user:s}=(await n.x.post("/auth/register",e)).data;localStorage.setItem("accessToken",t),localStorage.setItem("refreshToken",r),l(s)},h=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),l(null)},f=async()=>{try{let e=await n.x.get("/auth/me");l(e.data)}catch(e){h()}finally{i(!1)}};return(0,s.jsx)(o.Provider,{value:{user:r,isAuthenticated:!!r,isLoading:c,login:u,register:d,logout:h,refreshUser:f},children:t})}function c(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3447:function(e,t,r){"use strict";r.d(t,{Z:function(){return c},j:function(){return i}});var s=r(7573),a=r(7653),n=r(1493),o=r(286);let l=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[i,u]=(0,a.useState)(!1),{isAuthenticated:d}=(0,o.a)();(0,a.useEffect)(()=>{d?h():c(null)},[d]);let h=async()=>{try{u(!0);let e=await n.x.get("/cart");c(e.data)}catch(e){console.error("Failed to fetch cart:",e)}finally{u(!1)}};return(0,s.jsx)(l.Provider,{value:{cart:r,isLoading:i,fetchCart:h,clearCart:()=>{c(null)}},children:t})}function i(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},1493:function(e,t,r){"use strict";r.d(t,{x:function(){return a}});var s=r(3908);let a=s.Z.create({baseURL:"http://localhost:8080",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token");let{accessToken:t}=(await s.Z.post("".concat("http://localhost:8080","/auth/refresh"),{refreshToken:e})).data;return localStorage.setItem("accessToken",t),r.headers.Authorization="Bearer ".concat(t),a(r)}catch(e){return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/auth/login",Promise.reject(e)}}return Promise.reject(e)})},2625:function(){}},function(e){e.O(0,[31,108,293,528,744],function(){return e(e.s=999)}),_N_E=e.O()}]);