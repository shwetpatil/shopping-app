(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4570:function(e,t,n){Promise.resolve().then(n.bind(n,8439))},8439:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var r=n(7573),s=n(9703),i=n.n(s),l=n(7653);class o{publish(e,t){let n={type:e,payload:t};this.eventHistory.push(n),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift();let r=this.listeners.get(e);r&&r.forEach(n=>{try{n(t)}catch(t){console.error('[EventBus] Error in handler for "'.concat(e,'":'),t)}}),window.dispatchEvent(new CustomEvent("mfe:event",{detail:n,bubbles:!0}))}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{let n=this.listeners.get(e);n&&(n.delete(t),0===n.size&&this.listeners.delete(e))}}subscribeMultiple(e){let t=e.map(e=>{let{type:t,handler:n}=e;return this.subscribe(t,n)});return()=>{t.forEach(e=>e())}}getHistory(){return[...this.eventHistory]}clearHistory(){this.eventHistory=[]}getActiveSubscriptions(){let e=new Map;return this.listeners.forEach((t,n)=>{e.set(n,t.size)}),e}clear(){this.listeners.clear(),this.eventHistory=[]}constructor(){this.listeners=new Map,this.eventHistory=[],this.maxHistorySize=50}}let a=new o;function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=(0,l.useRef)(t);(0,l.useEffect)(()=>{r.current=t},[t]),(0,l.useEffect)(()=>a.subscribe(e,e=>{r.current(e)}),[e,...n])}class u{mark(e){this.marks.set(e,performance.now())}measure(e,t,n){let r=this.marks.get(t);if(!r)return null;let s=performance.now()-r;return this.metrics.push({name:e,duration:s,timestamp:Date.now(),mfeName:n}),this.marks.delete(t),s}getMetrics(){return[...this.metrics]}clearMetrics(){this.metrics=[]}reportToAnalytics(){window.gtag&&this.metrics.forEach(e=>{window.gtag("event","timing_complete",{name:e.name,value:Math.round(e.duration),event_category:e.mfeName||"MFE"})})}constructor(){this.metrics=[],this.marks=new Map}}new u;class d{initialize(e){this.environment=e.environment||"development",Object.entries(e.flags).forEach(e=>{let[t,n]=e;this.flags.set(t,n)}),console.log("[FeatureFlags] Initialized with ".concat(this.flags.size," flags in ").concat(this.environment," mode"))}isEnabled(e,t){let n=this.flags.get(e);if(!n)return console.warn('[FeatureFlags] Flag "'.concat(e,'" not found, defaulting to false')),!1;if(t&&n.mfeScope&&!n.mfeScope.includes(t))return!1;if(void 0!==n.rolloutPercentage&&n.rolloutPercentage<100){let t=this.getUserId();return this.hashString("".concat(e,"-").concat(t))%100<n.rolloutPercentage}return n.enabled}setFlag(e,t){let n=this.flags.get(e);n&&(n.enabled=t,this.flags.set(e,n),console.log('[FeatureFlags] Updated flag "'.concat(e,'" to ').concat(t)))}getAllFlags(){return Array.from(this.flags.values())}getUserId(){let e=localStorage.getItem("mfe-user-id");return e||(e=Math.random().toString(36).substring(7),localStorage.setItem("mfe-user-id",e)),e}hashString(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return Math.abs(t)}constructor(){this.flags=new Map,this.environment="development"}}new d;var h=n(4859);h.env.NEXT_PUBLIC_API_GATEWAY,h.env.NEXT_PUBLIC_SHELL_URL,h.env.NEXT_PUBLIC_SEARCH_URL,h.env.NEXT_PUBLIC_WISHLIST_URL,h.env.NEXT_PUBLIC_REVIEWS_URL,h.env.NEXT_PUBLIC_PRODUCTS_URL,h.env.NEXT_PUBLIC_CART_URL,h.env.NEXT_PUBLIC_ENABLE_ANALYTICS,h.env.NEXT_PUBLIC_ENABLE_ERROR_TRACKING,h.env.NEXT_PUBLIC_ENABLE_PERFORMANCE,h.env.NEXT_PUBLIC_CDN_URL;class f{initialize(){{let e=localStorage.getItem(this.tokenKey),t=localStorage.getItem(this.userKey);if(e&&t)try{let n=JSON.parse(t);this.setState({user:n,token:e,isAuthenticated:!0,isLoading:!1})}catch(e){console.error("[Auth] Failed to parse user data:",e),this.clearAuth()}else this.state.isLoading=!1}}login(e,t){this.setState({user:e,token:t,isAuthenticated:!0,isLoading:!1}),localStorage.setItem(this.tokenKey,t),localStorage.setItem(this.userKey,JSON.stringify(e)),a.publish("auth:login",{user:e,token:t})}logout(){this.clearAuth(),a.publish("auth:logout",{})}updateUser(e){if(!this.state.user)return;let t={...this.state.user,...e};this.setState({...this.state,user:t}),localStorage.setItem(this.userKey,JSON.stringify(t))}getToken(){return this.state.token}getUser(){return this.state.user}isAuthenticated(){return this.state.isAuthenticated}getState(){return{...this.state}}setState(e){this.state=e}clearAuth(){this.setState({user:null,token:null,isAuthenticated:!1,isLoading:!1}),localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.userKey)}constructor(){this.state={user:null,token:null,isAuthenticated:!1,isLoading:!0},this.tokenKey="mfe_auth_token",this.userKey="mfe_user_data"}}new f;let m=i()(()=>n.e(389).then(n.bind(n,9389)).then(e=>e.SearchBar),{loadableGenerated:{webpack:()=>[9389]},loading:()=>(0,r.jsx)("div",{className:"h-12 bg-gray-200 animate-pulse rounded"}),ssr:!1}),g=i()(()=>n.e(275).then(n.bind(n,4275)).then(e=>e.ProductGrid),{loadableGenerated:{webpack:()=>[4275]},loading:()=>(0,r.jsx)("div",{className:"h-96 bg-gray-200 animate-pulse rounded"}),ssr:!1});function p(){var e;c("search:filter",e=>{console.log("[Shell] Search filters changed:",e)}),c("cart:add",e=>{console.log("[Shell] Product added to cart:",e)});let t=(e="search:filter",(0,l.useCallback)(t=>{a.publish(e,t)},[e]));return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("section",{className:"mb-12 text-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Welcome to Our Microfrontend Shopping App"}),(0,r.jsx)("p",{className:"text-xl text-gray-600 mb-8",children:"Built with independently deployable modules for scalability and team autonomy"}),(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading search..."}),children:(0,r.jsx)(m,{onSearch:e=>{t(e)},placeholder:"Search products..."})})]}),(0,r.jsxs)("section",{className:"mb-12",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold mb-6",children:"Featured Products"}),(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading products..."}),children:(0,r.jsx)(g,{})})]}),(0,r.jsxs)("section",{className:"bg-blue-50 rounded-lg p-8 mb-12",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Microfrontend Architecture"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-2",children:"\uD83D\uDD0D Search MFE"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Port 3001 - Independent search module"})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-2",children:"\uD83D\uDECD️ Products MFE"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Port 3004 - Product catalog module"})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-2",children:"❤️ Wishlist MFE"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Port 3002 - Wishlist management"})]})]})]})]})}},4859:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(9566)},9566:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function i(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(e){n=l}}();var a=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?a=r.concat(a):u=-1,a.length&&h())}function h(){if(!c){var e=o(d);c=!0;for(var t=a.length;t;){for(r=a,a=[];++u<t;)r&&r[u].run();u=-1,t=a.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new f(e,t)),1!==a.length||c||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}},l=!0;try{t[e](i,i.exports,r),l=!1}finally{l&&delete n[e]}return i.exports}r.ab="//";var s=r(229);e.exports=s}()},9703:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let r=n(1887);n(7573),n(7653);let s=r._(n(8379));function i(e,t){var n;let r={loading:e=>{let{error:t,isLoading:n,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let i={...r,...t};return(0,s.default)({...i,modules:null==(n=i.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2972:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let r=n(951);function s(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return n}},8379:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let r=n(7573),s=n(7653),i=n(2972),l=n(9111);function o(e){return{default:e&&"default"in e?e.default:e}}let a={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},c=function(e){let t={...a,...e},n=(0,s.lazy)(()=>t.loader().then(o)),c=t.loading;function u(e){let o=c?(0,r.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,a=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(l.PreloadCss,{moduleIds:t.modules}):null,(0,r.jsx)(n,{...e})]}):(0,r.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(n,{...e})});return(0,r.jsx)(s.Suspense,{fallback:o,children:a})}return u.displayName="LoadableComponent",u}},9111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return i}});let r=n(7573),s=n(2399);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=(0,s.getExpectedRequestStore)("next/dynamic css"),i=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[293,528,744],function(){return e(e.s=4570)}),_N_E=e.O()}]);